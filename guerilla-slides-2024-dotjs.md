<img src="https://upload.wikimedia.org/wikipedia/commons/8/80/Che_Guevara_-_Guerrillero_Heroico_by_Alberto_Korda.jpg" alt="Che Guevara" style="height:100px;"/>

## SWIG JavaScript Evolution and the `hadron` build system

### The guerilla-slides-2024.js

<img src="https://upload.wikimedia.org/wikipedia/en/e/e0/Che_Guevara_Guerrilla_Warfare.jpg" alt="Guerilla Warfare" style="height:250px;"/>

[comment]: # (!!!)

JavaScript has become the new universal language
 * because of the research money and effort that went into highly efficient interpreters
 * because it allows to share backend and frontend code
 * because it is a not opinionated and very easy to learn and use
 * because it has a huge and totally free ecosystem where everyone is welcome
 * and partly by accident

[comment]: # (!!!)

JavaScript is notoriously difficult to interoperate with from another language.

For the last two decades, people have been trying to rewrite all existing software in JavaScript - there was no way around it.

But is this actually feasible?

[comment]: # (!!!)

During my work, I have needed three universally used libraries with very wide support that do not exist (did not exist) for JavaScript:

* ImageMagick
* ffmpeg
* GDAL

Rewriting these in JavaScript is a monumental task. Go and try searching on `npmjs` any of these. You will find tons of packages - most of them call the CLI tools - and are usually in a very sorry state.

[comment]: # (!!!)

Automatically generating wrappers for high-level interpreted languages by compiling the C/C++ header files is a solved problem: it is called 

# SWIG

[comment]: # (!!!)

## The Holy Grail of JavaScript/C++ interoperability

```shell
git clone https://github.com/ImageMagick/ImageMagick
abracadabra ImageMagick
```

=>

```js
import { Magick } from '@abracadabra/ImageMagick';
```

Works both in Node.js and in the browser.

[comment]: # (!!!)

## We are not there yet
*But we are moving in the right direction*

* ImageMagick requires about 600 lines of hand-written SWIG code - for 400K lines of C++ code, a very good ratio
* The code is compiled to native code for Node.js and WASM for the browser
* The bindings support both synchronous and asynchronous mode - both in Node.js and in the browser (in the browser, it requires COOP/COEP)

[comment]: # (!!!)

* The TypeScript types are autogenerated
* The `npm` package can rebuild itself, pulling all the required libraries from `conan`, with optional support for a built-in compiler (the software must be fully compatible with being built with `clang` on all platforms) - that does not need **anything** besides Node.js from the user host

[comment]: # (!!!)

<img src="https://upload.wikimedia.org/wikipedia/commons/c/c4/RUEDA_DE_PRENSA_CONJUNTA_ENTRE_CANCILLER_RICARDO_PATI%C3%91O_Y_JULIAN_ASSANGE_%28cropped%29.jpg" alt="Julian Assange" style="height:200px;"/>

A few days ago, Julian Assange struck a deal with the US government to serve 5 more years.

The fact that, after almost 10 years in various forms of solitary confinement, he has to serve 5 more years in jail, is our fault.

Everyone's fault.

[comment]: # (!!!)


<iframe width="560" height="315" src="https://www.youtube.com/watch?v=XF-RHOqGz-Y&t=9s" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
